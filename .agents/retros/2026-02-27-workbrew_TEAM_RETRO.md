# Team Retro — WorkBrew (Cafe & WiFi Finder)

__Date:__ 2026-02-27
__Scope:__ Full project — scope, design, development, QA, deployment
__Deployed URL:__ [https://workbrew-m517.onrender.com/](https://workbrew-m517.onrender.com/)

---

## What went well

**Cap (OPST Team Lead)**

The entire MVP was delivered in a single focused session — 7 commits, zero rework on core architecture. The factory pattern for the Flask app (`create_app()`) proved a strong choice upfront: it made testing completely clean and deployment trivial. Schema isolation via `search_path` was an elegant, model-transparent solution; no model changes were needed to slot WorkBrew into the existing shared Postgres instance. The seed-on-startup pattern (`python seed.py && gunicorn app:app`) solved the free-tier shell access limitation cleanly and idiomatically.

**Stella (Python Developer)**

The Tailwind CDN approach kept the frontend fast to iterate. Jinja2 + WTForms integration was tight — CSRF protection, field rendering, and error display were all handled by the framework with minimal boilerplate. The filter chip bar (URL query params → backend filter → template re-render) required zero JavaScript and stayed fully shareable by design. The Leaflet map with JSON-serialized cafe pins worked first try.

**Sentinel (Security)**

Session-based admin auth using env var credentials is appropriately scoped for a single-admin public tool. CSRF via Flask-WTF covers all state-changing forms. The `abort(403)` guard on delete is clean. `SECRET_KEY` is generated by Render at deploy time. No user table means no credential storage attack surface. The honepot field stretch goal remains open as a nice-to-have for spam reduction.

**Vera (QA)**

35/35 tests passing, 97% coverage on first full run after the fixture was stabilized. The factory + temp-file SQLite pattern ended up being the right fixture design — in-memory StaticPool did not provide request-level isolation. Flash message content caused a false positive on the delete test that required three fix iterations before the root cause (checking bare text vs. HTML element pattern) was identified.

**Nexus (DevOps)**

`render.yaml` Blueprint deployment was clean. Using `sync: false` for secrets and `generateValue: true` for `SECRET_KEY` is the correct production pattern. The `runtime.txt` pin to Python 3.12 avoided psycopg2-binary wheel build failures. `CREATE SCHEMA IF NOT EXISTS` at cold start made the schema bootstrapping fully idempotent.

__Rudi (Owner)__

Cap made a great translation of the existing API into the features that a webapp would need to support it. Stella made an impressive one-shot mockup, and I was skeptical that i'd like the first design that the team put into html/css instead of a mockup tooling process, but it was spot-on for the look we wanted. Not sure we'll get that lucky next time, so I'll look to push the team for better mock options from any of the tools they have skills and integrations for: claude artifact/figma/canva/excalidraw.

---

## What went wrong

**Cap (OPST Team Lead)**

`LOCAL_LOG.md` Phases 1–3 were never filled in — only Phase 0 (kickoff) was logged. The log was created correctly at project start but then never updated through development, QA, or deployment. This violated the continuous logging mandate in GLOBAL_EVOLUTION section 6. Retro was also not initiated by Cap — it was prompted by the Product Owner.

**Stella (Python Developer)**

The `instance/` folder was not added to `.gitignore` at project initialization, which caused `instance/cafes.db` to be tracked and pushed to the repo. This had to be corrected mid-project with `git rm --cached`. The fix belonged in Phase 0 setup.

**Vera (QA)**

The delete/homepage test required three fix cycles. Root cause analysis should have led immediately to checking what the flash message contained before assuming a fixture isolation problem. Two of the three fix iterations (StaticPool, temp-file SQLite) were correct improvements but did not address the actual failure.

**Nexus (DevOps)**

Original geocoded SQLite data was lost. A `db.drop_all()` call was committed in the test fixture without realizing it would destroy the seeded data in `instance/cafes.db`. When the Product Owner provided `cafes_orig.db` as a backup, a git history recovery attempt was made but the extracted blob also had no tables (drop_all had been committed at that point). Re-geocoding via Nominatim recovered all 21 records, but this was avoidable.

__Rudi (Owner):__

Nothing really "wrong", team executed a great plan. The opening teamlead wakeup workflow needs some work, it should be easier for me to wake up Cap and him to know where he's at, we've written that a few ways (probably too many), so i'll look to consolidate the flow into something simpler that 1. nails the symbolic link to CLAUDE.md in _OPST, and then CLAUDE has links to whatever it needs to not be confused.
---

## What did we discover

**Cap (OPST Team Lead)**

Skills must be explicitly looked up from `_OPST/assets/SKILLS/<skill>/SKILL.md` when the Product Owner invokes them by name. The "retro skill" invocation failed because Cap attempted to use the Skill tool instead of reading the file directly. GLOBAL_EVOLUTION step 4 has been updated to document this pattern.

**Stella (Python Developer)**

`db.create_all()` must live outside `if __name__ == "__main__"` to run under gunicorn. The pattern of putting bootstrap code under the `__main__` guard is natural for scripts but silently breaks WSGI deployments where `__main__` is never true.

**Vera (QA)**

Flask flash messages persist in session across a redirect. When testing delete → redirect → homepage, `follow_redirects=True` renders the flash banner on the same response. Asserting `b"CafeName"` without an HTML anchor (e.g., `b"CafeName</h3>"`) will produce a false positive if the name appears in a flash message.

**Nexus (DevOps)**

`instance/` must be in `.gitignore` from day one (added to project setup workflow). PostgreSQL schema isolation via `search_path` in `SQLALCHEMY_ENGINE_OPTIONS.connect_args` is cleaner than per-model `__table_args__ = {"schema": ...}` — it requires no model changes and is transparent to all ORM queries. The `python seed.py && gunicorn` chain is a reusable pattern for free-tier Render deployments where one-time setup must run before the server starts.

__Rudi (Owner):__

ASCII mockups are kind of a waste, let's make sure we're doing excalidraw at a minimum.
---

_Product Owner review complete (2026-02-27). Learnings extracted to `.agents/learnings/2026-02-27-workbrew.md`._
